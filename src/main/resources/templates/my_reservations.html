<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/header :: header}"></head>
<body>
    <div th:replace="~{layout/navbar :: navbar}"></div>
    
    <div class="container">
        <div class="card">
            <h1>내 예약 목록 ✈️</h1>
            
            <div th:if="${#lists.isEmpty(reserves)}" class="alert alert-info">
                <p>예약된 항공편이 없습니다.</p>
            </div>
            
            <div th:unless="${#lists.isEmpty(reserves)}" class="reserve-list">
                <div th:each="reserve : ${reserves}" class="card reserve-card">
                    <div class="reserve-info">
                        <div>
                            <strong>항공사:</strong> <span th:text="${reserve.seatsRel.airplane.airline}"></span>
                        </div>
                        <div>
                            <strong>항공편:</strong> <span th:text="${reserve.flightNo}"></span>
                        </div>
                        <div>
                            <strong>출발:</strong> 
                            <span th:text="${reserve.seatsRel.airplane.departureAirport}"></span>
                            (<span th:text="${#temporals.format(reserve.departureDateTime, 'yyyy-MM-dd HH:mm')}"></span>)
                        </div>
                        <div>
                            <strong>도착:</strong> 
                            <span th:text="${reserve.seatsRel.airplane.arrivalAirport}"></span>
                            (<span th:text="${#temporals.format(reserve.seatsRel.airplane.arrivalDateTime, 'yyyy-MM-dd HH:mm')}"></span>)
                        </div>
                        <div>
                            <strong>결제 금액:</strong>
                            <span th:text="${#numbers.formatInteger(reserve.payment, 0, 'COMMA') + '원'}"></span>
                        </div>
                        <div>
                            <strong>예약일:</strong> 
                            <span th:text="${#temporals.format(reserve.reserveDateTime, 'yyyy-MM-dd HH:mm')}"></span>
                        </div>
                        <div class="reserve-actions">
                            <form th:action="@{/reservations/cancel}"
                                  method="post"
                                  onsubmit="return confirm(
                                      '정말로 이 예약을 취소하시겠습니까?\n\n' +
                                      '--- 취소 위약금 규정 ---\n' +
                                      '출발 15일 이전: 150,000원\n' +
                                      '출발 14일 ~ 4일 전: 180,000원\n' +
                                      '출발 3일 전 ~ 1일 전: 250,000원\n' +
                                      '출발 당일: 전액 환불 불가\n\n' +
                                      '취소 후에는 되돌릴 수 없습니다.'
                                  );">

                                <input type="hidden" name="flightNo" th:value="${reserve.flightNo}">
                                <input type="hidden" name="departureDateTime" th:value="${reserve.departureDateTime}">
                                <input type="hidden" name="seatClass" th:value="${reserve.seatClass}">

                                <button type="submit" class="btn btn-danger">예약 취소</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 
